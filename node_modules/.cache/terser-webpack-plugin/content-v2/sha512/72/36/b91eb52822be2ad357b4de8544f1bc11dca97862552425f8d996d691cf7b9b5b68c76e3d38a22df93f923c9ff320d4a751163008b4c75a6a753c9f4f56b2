{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";n.r(e);class i{constructor({element:t}){this._el=t}on(t,e){this._el.addEventListener(t,e)}}class a extends i{constructor({element:t,data:e}){super({element:t}),this.displayData(e),this._el.addEventListener(\"click\",t=>this._onRowClick(t))}displayData(t){this._render(t)}_onRowClick(t){const e=t.target.closest(\"tr\");if(!e)return;const n=e.dataset.id;if(n){let t=new CustomEvent(\"rowClick\",{detail:n});this._el.dispatchEvent(t)}}_render(t){this._el.innerHTML=`\\n    <table class=\"data-table highlight\"> \\n        <thead>\\n        <tr>\\n            <th>Name</th>\\n            <th>Symbol</th>\\n            <th>Rank</th>\\n            <th>Price</th>\\n        </tr>\\n        </thead>\\n\\n        <tbody>\\n            ${t.map(t=>`\\n              <tr data-id=\"${t.id}\">\\n                  <td>${t.name}</td>\\n                  <td>${t.symbol}</td>\\n                  <td>${t.rank}</td>\\n                  <td>${t.price}</td>\\n              </tr>\\n            `).join(\"\")}\\n        </tbody>\\n    </table>\\n\\n    `}}class s{constructor({element:t,balance:e}){this._el=t,this._balance=e,this._items={},this._portfolioWorth=0,this._render()}addItem(t,e){const n=this._items[t.id]||{name:t.name,id:t.id,amount:0,total:0};n.price=t.price,n.amount=n.amount+e,n.total=n.price*n.amount,this._items[t.id]=n;const i=t.price*e;this._balance=this._balance-i,this._portfolioWorth=Object.values(this._items).reduce((t,e)=>t+e.total,0),this._render()}_render(t){const e=Object.values(this._items);this._el.innerHTML=`\\n      <div class=\"card-panel hoverable center-align\">\\n          <p>\\n              Current balance: ${this._balance}\\n              <br />\\n              Portfolio Worth: ${this._portfolioWorth}\\n          </p>\\n          ${0===e.length?\"\":`\\n              <table class=\"highlight striped\"> \\n                <thead>\\n                  <tr>\\n                      <th>Name</th>\\n                      <th>Amount</th>\\n                      <th>Price</th>\\n                      <th>Total</th>\\n                  </tr>\\n                </thead>\\n        \\n                <tbody>\\n                    ${e.map(t=>`\\n                      <tr data-id=\"${t.id}\">\\n                          <td>${t.name}</td>\\n                          <td>${t.amount}</td>\\n                          <td>${t.price}</td>\\n                          <td>${t.total}</td>\\n                      </tr>\\n                    `).join(\"\")}\\n                  </tbody>\\n                </table>`}\\n      </div>\\n    `}}class l extends i{constructor({element:t}){super({element:t}),this._el.addEventListener(\"click\",t=>{if(t.target.closest(\"#btn-cancel\")&&this.close(),t.target.closest(\"#btn-buy\")){let t=new CustomEvent(\"buy\",{detail:{item:this._currentItem,amount:+this._el.querySelector(\"#amount\").value}});this._el.dispatchEvent(t),this.close()}}),this._el.addEventListener(\"keydown\",t=>{if(!t.target.closest(\"#amount\"))return;const{key:e}=t;(function(t){return!isNaN(parseFloat(t))&&isFinite(t)})(e)||\"Backspace\"===e||t.preventDefault()}),this._el.addEventListener(\"input\",t=>{if(!t.target.closest(\"#amount\"))return;const e=t.target.value;this._total=this._currentItem.price*Number(e),this._updateDisplay(this._total)})}close(){this._el.querySelector(\".modal\").classList.remove(\"open\")}trade(t){this._currentItem=t,this._total=0,this._render(t)}_updateDisplay(t){this._totalEl=this._el.querySelector(\"#item-total\"),this._totalEl.textContent=t}_render(t){this._el.innerHTML=`\\n      <div id=\"modal\" class=\"modal open\">\\n        <div class=\"modal-content\">\\n          <h4>Buying ${t.name}:</h4>\\n          <p>\\n            Current price: ${t.price}. Total: <span id=\"item-total\">${this._total}</span>\\n          </p>\\n          <div class=\"row\">\\n            <form class=\"col s12\">\\n                <div class=\"input-field col s4\">\\n                    <input id=\"amount\" type=\"text\">\\n                    <label for=\"amount\">Amount</label>\\n                </div>\\n            </form>\\n            </div>\\n        </div>\\n        \\n        <div class=\"modal-footer\">\\n          <a href=\"#!\" id=\"btn-buy\" class=\"modal-close waves-effect waves-teal btn-flat\">Buy</a>\\n          <a href=\"#!\" id=\"btn-cancel\" class=\"modal-close waves-effect waves-teal btn-flat\">Cancel</a>\\n        </div>\\n    </div>\\n    `}}var r={sendRequest:t=>fetch(t).then(t=>t.json()),sendMultipleRequests(t){let e=t.map(t=>this.sendRequest(t));return Promise.all(e)}};var o={async getCurrencies(){try{let t=await r.sendRequest(\"https://api.coinpaprika.com/v1/coins\");console.log(t);const e=(t=t.slice(0,10)).map(t=>(t=>`https://api.coinpaprika.com/v1/coins/${t}/ohlcv/latest/`)(t.id)),n=await r.sendMultipleRequests(e);return t.map((t,e)=>(t.price=n[e][0].close,t))}catch(t){console.log(t)}}};class d extends i{constructor({element:t}){super({element:t}),this._el=t,this._render(),this._el.addEventListener(\"input\",function(t,e){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>{t.apply(this,i)},e)}}(t=>{let e=t.target.value,n=new CustomEvent(\"filter\",{detail:e.toLowerCase()});this._el.dispatchEvent(n)},500))}_render(){this._el.innerHTML='\\n      <div class=\"input-field col s4\">\\n          <input type=\"text\">\\n          <label for=\"first_name\">Filter</label>\\n      </div>\\n    '}}new class{constructor({element:t}){this._el=t,this._userBalance=1e4,this._render(),this._initPortfolio(),this._initTradeWidget(),this._initFilter(),this._initTable(),console.log(\"here\")}async _initTable(){let t=await o.getCurrencies();this._data=t,this._table=new a({data:t,element:this._el.querySelector('[data-element=\"table\"]')}),this._table.on(\"rowClick\",t=>{this._tradeItem(t.detail)})}_initPortfolio(){this._portfolio=new s({element:this._el.querySelector('[data-element=\"portfolio\"]'),balance:this._userBalance})}_initTradeWidget(){this._tradeWidget=new l({element:this._el.querySelector('[data-element=\"trade-widget\"]')}),this._tradeWidget.on(\"buy\",t=>{const{item:e,amount:n}=t.detail;this._portfolio.addItem(e,n)})}_tradeItem(t){const e=this._data.find(e=>e.id===t);this._tradeWidget.trade(e)}_initFilter(){this._filter=new d({element:this._el.querySelector('[data-element=\"filter\"]')}),this._filter.on(\"filter\",t=>{const e=t.detail,n=this._data.filter(t=>t.name.toLowerCase().includes(e));this._table.displayData(n)})}_render(){this._el.innerHTML='\\n      <div class=\"row\">\\n          <div class=\"col s12\">\\n              <h1>Tiny Crypto Market</h1>\\n          </div>\\n      </div>\\n      <div class=\"row portfolio-row\">\\n          <div class=\"col s6 offset-s6\" data-element=\"portfolio\"></div>\\n      </div>\\n      <div class=\"row\" data-element=\"filter\"></div>\\n      <div class=\"row\">\\n          <div class=\"col s12\" data-element=\"table\"></div>\\n      </div>\\n      <div data-element=\"trade-widget\"></div>\\n    '}}({element:document.getElementById(\"app\")})}]);","extractedComments":[]}